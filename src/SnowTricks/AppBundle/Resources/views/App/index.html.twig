{% extends "base.html.twig" %}
{% block title %}Accueil{% endblock %}

{% block header %}
<!-- Header -->
<header class="masthead">
    <div class="container">
        <div class="intro-text">
            <div class="intro-lead-in">Bienvenue sur SnowTricks !</div>
            <div class="intro-heading text-uppercase">Le Wiki du snowboard</div>
            <a class="btn btn-primary btn-xl js-scroll-trigger" href="#services">See Tricks</a>
        </div>
    </div>
</header>
{% endblock %}

{% block content %}

    <section>
        <div class="row" id="tricks-data">
            {{ render(controller('SnowTricksTrickBundle:Trick:listTricks')) }}
        </div>
        <div class="ajax-load text-center" style="display:none">
            <p><img src="http://demo.itsolutionstuff.com/plugin/loader.gif">Loading More post</p>
        </div>
    </section>

    {{ include('@SnowTricksTrick/modals/delete_trick.html.twig') }}
{% endblock %}

{% block javascripts %}

    {{ parent() }}
    <script type="text/javascript">
        var stop = 1;
        var url = "{{ path('snow_tricks_list_tricks_ajax', {'id': 'null'})|escape('js') }}";
        url = url.replace('null', '');

        if($(".portfolio-item").length < 15)
        {
            stop = 0;
        }

        $(window).scroll(function() {

            if(stop > 0)
            {
                if($(window).scrollTop() + $(window).height() >= $(document).height()) {
                    var last_id = $(".portfolio-item:last").attr("id");
                    loadMoreData(last_id);
                }
            }

        });


        function loadMoreData(last_id){
            $.ajax(
                {
                    url: url+last_id,
                    type: "get",
                    beforeSend: function()
                    {
                        $('.ajax-load').show();

                    }
                })
                .done(function(data)
                {
                    if(!data)
                        stop--;

                    $('.ajax-load').hide();
                    $("#tricks-data").append(data);
                })
                .fail(function(jqXHR, ajaxOptions, thrownError)
                {
                    alert('server not responding...');
                });
        }
    </script>

{% endblock %}